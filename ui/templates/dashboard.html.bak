{{define "dashboard.html"}}
<div x-data="{ 
    lastRefresh: new Date(),
    refreshInterval: null,
    formatTime(date) {
        return date.toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit' });
    },
    startAutoRefresh() {
        this.refreshInterval = setInterval(() => {
            htmx.trigger('#dashboard-content', 'refresh');
        }, 30000);
    },
    manualRefresh() {
        htmx.trigger('#dashboard-content', 'refresh');
    }
}" x-init="startAutoRefresh()">
    
    <div class="flex items-center justify-between">
        <div>
            <div class="flex items-center gap-3">
        <h2 class="text-2xl font-bold">Dashboard</h2>
                <!-- Mini Auto-refresh Indicator -->
                <div class="flex items-center gap-2 text-xs">
                    <button 
                        @click="manualRefresh()"
                        title="Refresh now (auto-refresh: 30s)"
                        class="p-1.5 rounded-md hover:bg-gray-800 transition-colors group">
                        <div class="relative flex items-center justify-center">
                            <svg class="w-3.5 h-3.5 text-gray-500 group-hover:text-emerald-400 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                            </svg>
                            <span id="refresh-spinner" class="htmx-indicator absolute inset-0 flex items-center justify-center">
                                <svg class="w-3.5 h-3.5 text-emerald-400 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                </svg>
                            </span>
                        </div>
                    </button>
                    <span class="text-gray-500 font-mono" x-text="formatTime(lastRefresh)"></span>
                </div>
            </div>
            <p class="text-xs text-gray-500 mt-1.5 flex items-center gap-3">
                <span class="inline-flex items-center gap-1.5">
                    <span class="w-1.5 h-1.5 rounded-full bg-red-500 animate-pulse"></span>
                    <span class="text-red-400 font-medium">Real-time</span>
                    <span class="text-gray-600">Redis Streams</span>
                </span>
                <span class="text-gray-700">‚Ä¢</span>
                <span class="inline-flex items-center gap-1.5">
                    <span class="w-1.5 h-1.5 rounded-full bg-purple-500"></span>
                    <span class="text-purple-400 font-medium">Historical</span>
                    <span class="text-gray-600">PostgreSQL</span>
                </span>
            </p>
        </div>
        <div class="flex items-center gap-4">
            <!-- Consumer Group Selector -->
            {{if .ConsumerGroups}}
            <div class="flex items-center gap-3">
                <label class="text-sm text-gray-400">Consumer Group:</label>
                <select 
                    onchange="window.location.href = '/?group=' + this.value"
                    class="bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-strego-500"
                >
                    {{range .ConsumerGroups}}
                    <option value="{{.Name}}" {{if eq $.SelectedGroup .Name}}selected{{end}}>
                        {{.Name}} ({{.ConsumerCount}} workers)
                    </option>
                    {{end}}
                </select>
            </div>
            {{else}}
            <div class="text-sm text-gray-500 px-4 py-2 bg-gray-800/50 rounded-lg">
                No active consumer groups
            </div>
            {{end}}
        <div class="flex items-center gap-2 text-sm text-gray-500">
            <span class="htmx-indicator">
                <svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            </span>
            <span>Auto-refresh: 5s</span>
        </div>
        </div>
    </div>
    
    <!-- Dashboard Content - Auto-refreshable -->
    <div id="dashboard-content" 
         hx-get="/?group={{.SelectedGroup}}" 
         hx-trigger="refresh"
         hx-swap="innerHTML"
         hx-select="#dashboard-content > *"
         @htmx:after-swap="lastRefresh = new Date()"
         hx-indicator="#refresh-spinner"
         class="space-y-6">
         
    <!-- Stats Cards (PostgreSQL) -->
        {{if .Stats}}
    <div class="bg-gray-900 rounded-xl border border-gray-800" x-data="{ expanded: true }">
        <div class="p-4 border-b border-gray-800 flex items-center justify-between cursor-pointer" @click="expanded = !expanded">
            <div class="flex items-center gap-3">
                <h3 class="font-semibold">üìä System Statistics</h3>
                <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs bg-purple-900/30 text-purple-400 border border-purple-800/50">
                    <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M3 12v3c0 1.657 3.134 3 7 3s7-1.343 7-3v-3c0 1.657-3.134 3-7 3s-7-1.343-7-3z"/>
                        <path d="M3 7v3c0 1.657 3.134 3 7 3s7-1.343 7-3V7c0 1.657-3.134 3-7 3S3 8.657 3 7z"/>
                        <path d="M17 5c0 1.657-3.134 3-7 3S3 6.657 3 5s3.134-3 7-3 7 1.343 7 3z"/>
                    </svg>
                    Historical ‚Ä¢ PostgreSQL
                </span>
                <div class="relative inline-flex items-center group" @click.stop="">
                    <svg class="w-4 h-4 text-gray-500 hover:text-gray-300 cursor-help" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                    </svg>
                    <div class="absolute top-full left-1/2 -translate-x-1/2 mt-2 hidden group-hover:block z-50">
                        <div class="bg-gray-800 text-white text-xs rounded-lg py-2 px-3 w-64 shadow-xl border border-gray-700">
                            <div class="font-semibold mb-2">Task States (PostgreSQL):</div>
                            <div class="space-y-1">
                                <div class="flex items-center gap-2">
                                    <span class="text-yellow-400">‚è≥ Pending:</span>
                                    <span class="text-gray-300">Not yet picked up by any worker</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-cyan-400">‚ö° Active:</span>
                                    <span class="text-gray-300">Currently being processed</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-green-400">‚úÖ Completed:</span>
                                    <span class="text-gray-300">Successfully finished</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-red-400">üíÄ Dead:</span>
                                    <span class="text-gray-300">Failed after max retries</span>
                                </div>
                            </div>
                            <div class="mt-2 pt-2 border-t border-gray-700 text-gray-400 text-xs">
                                Historical data aggregated across all consumer groups.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <svg class="w-5 h-5 text-gray-400 transition-transform" :class="expanded ? 'rotate-180' : ''" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
        </div>
        <div class="p-4" x-show="expanded" x-transition>
            <div id="stats" hx-get="/partials/stats" hx-trigger="load, every 5s" hx-swap="innerHTML">
            {{template "partial_stats.html" .Stats}}
            </div>
        </div>
    </div>
    {{end}}

    <!-- Workers in Consumer Group (Redis) -->
    {{if .Consumers}}
    <div class="bg-gray-900 rounded-xl border border-gray-800" x-data="{ expanded: true }">
        <div class="p-4 border-b border-gray-800 flex items-center justify-between cursor-pointer" @click="expanded = !expanded">
            <div class="flex items-center gap-3">
                <h3 class="font-semibold">üë• Workers in Consumer Group</h3>
                <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs bg-red-900/30 text-red-400 border border-red-800/50">
                    <span class="w-1.5 h-1.5 rounded-full bg-red-500 animate-pulse"></span>
                    Real-time ‚Ä¢ Redis Streams
                </span>
                <div class="relative inline-flex items-center group" @click.stop="">
                    <svg class="w-4 h-4 text-gray-500 hover:text-gray-300 cursor-help" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                    </svg>
                    <div class="absolute top-full left-1/2 -translate-x-1/2 mt-2 hidden group-hover:block z-50">
                        <div class="bg-gray-800 text-white text-xs rounded-lg py-2 px-3 w-64 shadow-xl border border-gray-700">
                            <div class="font-semibold mb-2">Worker Status:</div>
                            <div class="space-y-1">
                                <div class="flex items-center gap-2">
                                    <span class="text-green-400">üü¢ Active:</span>
                                    <span class="text-gray-300">Idle &lt; 1 minute</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-yellow-400">üü° Idle:</span>
                                    <span class="text-gray-300">Idle 1-10 minutes</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-red-400">üî¥ Dead:</span>
                                    <span class="text-gray-300">Idle &gt; 10 minutes</span>
                                </div>
                            </div>
                            <div class="mt-2 pt-2 border-t border-gray-700 text-gray-400 text-xs">
                                Dead workers with pending tasks will auto-recover via XAUTOCLAIM.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <span class="text-sm text-gray-500">{{len .Consumers}} workers</span>
                <div class="flex items-center gap-1.5" x-data="{ showCleanupModal: false }">
                    <button 
                        @click="showCleanupModal = true"
                        class="text-xs px-2.5 py-1.5 bg-red-600 hover:bg-red-500 text-white rounded-lg font-medium transition-all hover:shadow-lg hover:shadow-red-500/20 flex items-center gap-1.5"
                    >
                        <span id="cleanup-indicator" class="htmx-indicator">
                            <svg class="animate-spin h-3 w-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                        </span>
                        üßπ Cleanup
                    </button>

                    <!-- Cleanup Confirmation Modal -->
                    <div x-show="showCleanupModal" 
                         x-cloak
                         @click.self="showCleanupModal = false"
                         class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm"
                         style="display: none;">
                        <div class="bg-gray-900 border border-gray-700 rounded-xl shadow-2xl max-w-lg w-full mx-4 overflow-hidden"
                             @click.stop=""
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 scale-95"
                             x-transition:enter-end="opacity-100 scale-100">
                            <!-- Header -->
                            <div class="bg-gradient-to-r from-red-900/30 to-orange-900/30 px-6 py-4 border-b border-gray-700">
                                <div class="flex items-center gap-3">
                                    <div class="w-12 h-12 rounded-full bg-red-600/20 flex items-center justify-center">
                                        <span class="text-2xl">üßπ</span>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-bold text-white">Clean Up Dead Consumers</h3>
                                        <p class="text-sm text-gray-400">Remove inactive consumer entries</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Body -->
                            <div class="px-6 py-5 space-y-4">
                                <p class="text-gray-300">This will remove <span class="font-bold text-red-400">ONLY dead</span> consumer entries from Redis:</p>
                                
                                <div class="bg-gray-800/50 rounded-lg p-4 space-y-2 border border-gray-700">
                                    <div class="flex items-start gap-2 text-sm">
                                        <span class="text-red-400 mt-0.5">üî¥</span>
                                        <div>
                                            <span class="text-gray-400">Cleanup Target:</span>
                                            <span class="text-white font-medium ml-1">Dead consumers (idle > 10 min)</span>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-2 text-sm">
                                        <span class="text-emerald-400 mt-0.5">‚úì</span>
                                        <div>
                                            <span class="text-gray-400">Pending Tasks:</span>
                                            <span class="text-white font-medium ml-1">0 (no tasks will be lost)</span>
                                        </div>
                                    </div>
                                    <div class="flex items-start gap-2 text-sm">
                                        <span class="text-blue-400 mt-0.5">üì¶</span>
                                        <div>
                                            <span class="text-gray-400">Consumer Group:</span>
                                            <span class="text-white font-medium ml-1">{{.SelectedGroup}}</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-emerald-900/20 border border-emerald-700/30 rounded-lg p-3">
                                    <p class="text-sm text-emerald-300 flex items-center gap-2">
                                        <svg class="w-4 h-4 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                                        </svg>
                                        <span><strong>Active</strong> and <strong>idle</strong> workers will NOT be affected.</span>
                                    </p>
                                </div>
                            </div>

                            <!-- Footer -->
                            <div class="px-6 py-4 bg-gray-800/30 border-t border-gray-700 flex items-center justify-end gap-3">
                                <button 
                                    @click="showCleanupModal = false"
                                    class="px-4 py-2 rounded-lg bg-gray-700 hover:bg-gray-600 text-white text-sm font-medium transition-colors">
                                    Cancel
                                </button>
                                <button 
                                    hx-post="/admin/cleanup-consumers"
                                    hx-swap="none"
                                    hx-indicator="#cleanup-indicator"
                                    @click="showCleanupModal = false"
                                    class="px-4 py-2 rounded-lg bg-red-600 hover:bg-red-500 text-white text-sm font-medium transition-all hover:shadow-lg hover:shadow-red-500/20 flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                    </svg>
                                    Cleanup Now
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="relative inline-flex items-center group">
                        <svg class="w-5 h-5 text-gray-400 hover:text-gray-200 cursor-help transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <div class="absolute top-full mt-2 right-0 w-80 bg-gray-800 border border-gray-700 rounded-lg p-3 text-xs text-gray-300 shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50">
                            <div class="font-semibold text-white mb-1.5">Manual Consumer Cleanup</div>
                            <div class="space-y-1.5">
                                <p>Removes dead Redis consumer entries from the selected consumer group.</p>
                                <p class="text-gray-400"><span class="text-red-400 font-medium">Manual Criteria:</span> Pending = 0 tasks AND Idle > 10 minutes</p>
                                <p class="text-amber-400 text-[11px] italic">Note: If enabled on workers, server-side auto-cleanup runs periodically with a more conservative threshold.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <svg class="w-5 h-5 text-gray-400 transition-transform" :class="expanded ? 'rotate-180' : ''" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
            </div>
        </div>
        <div class="p-4 space-y-2" x-show="expanded" x-transition>
            {{range .Consumers}}
            <div class="flex items-center justify-between p-3 bg-gray-800/50 rounded-lg hover:bg-gray-800/70 transition-colors">
                <div class="flex items-center gap-3 flex-1">
                    <span class="inline-flex items-center gap-1.5 px-2 py-1 rounded text-xs {{.StatusClass}} font-medium">
                        {{.Status}}
                    </span>
                    <span class="text-sm font-mono text-strego-400">{{.Name}}</span>
                </div>
                <div class="flex items-center gap-4 text-xs">
                    <div class="flex items-center gap-1.5">
                        <span class="text-gray-400">Pending in PEL: <span class="text-yellow-400 font-medium">{{.Pending}}</span></span>
                        <div class="relative inline-flex items-center group">
                            <svg class="w-3.5 h-3.5 text-gray-600 hover:text-gray-400 cursor-help" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                            </svg>
                            <div class="absolute top-full left-1/2 -translate-x-1/2 mt-2 hidden group-hover:block z-50">
                                <div class="bg-gray-800 text-white text-xs rounded py-1.5 px-2 w-48 shadow-xl border border-gray-700 whitespace-nowrap">
                                    PEL = Pending Entries List (UNACKED tasks in Redis)
                                </div>
                            </div>
                        </div>
                    </div>
                    <span class="text-gray-400">Idle Time: <span class="text-gray-300 font-medium">{{.IdleTime}}</span></span>
                </div>
            </div>
        {{end}}
    </div>
    </div>
    {{end}}

    <!-- Queues Overview (Redis) -->
    <div class="bg-gray-900 rounded-xl border border-gray-800" x-data="{ expanded: true }">
        <div class="p-4 border-b border-gray-800 flex items-center justify-between cursor-pointer" @click="expanded = !expanded">
            <div class="flex items-center gap-3">
                <h3 class="font-semibold">üì¨ Queues {{if .SelectedGroup}}<span class="text-gray-500 text-sm font-normal">for {{.SelectedGroup}}</span>{{end}}</h3>
                <div class="relative inline-flex items-center group" @click.stop="">
                    <svg class="w-4 h-4 text-gray-500 hover:text-gray-300 cursor-help" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                    </svg>
                    <div class="absolute top-full left-1/2 -translate-x-1/2 mt-2 hidden group-hover:block z-50">
                        <div class="bg-gray-800 text-white text-xs rounded-lg py-2 px-3 w-72 shadow-xl border border-gray-700">
                            <div class="font-semibold mb-2">Queue States (Redis Streams):</div>
                            <div class="space-y-1">
                                <div class="flex items-start gap-2">
                                    <span class="text-yellow-400 whitespace-nowrap">‚è≥ Pending:</span>
                                    <span class="text-gray-300">Messages in stream, not yet consumed (XLEN - PEL)</span>
                                </div>
                                <div class="flex items-start gap-2">
                                    <span class="text-cyan-400 whitespace-nowrap">‚ö° Active:</span>
                                    <span class="text-gray-300">In PEL (delivered but not ACK'd) - includes crashed workers</span>
                                </div>
                                <div class="flex items-start gap-2">
                                    <span class="text-red-400 whitespace-nowrap">üíÄ Dead:</span>
                                    <span class="text-gray-300">DLQ tasks (moved after all retries exhausted)</span>
                                </div>
                                <div class="flex items-start gap-2">
                                    <span class="text-green-400 whitespace-nowrap">‚úÖ Completed:</span>
                                    <span class="text-gray-300">Acknowledged & removed from stream (from PostgreSQL)</span>
                                </div>
                            </div>
                            <div class="mt-2 pt-2 border-t border-gray-700 text-gray-400 text-xs">
                                Real-time view for this consumer group only.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs bg-red-900/30 text-red-400 border border-red-800/50">
                    <span class="w-1.5 h-1.5 rounded-full bg-red-500 animate-pulse"></span>
                    Real-time ‚Ä¢ Redis Streams
                </span>
            <a href="/queues" class="text-sm text-strego-400 hover:text-strego-300">View all ‚Üí</a>
                <svg class="w-5 h-5 text-gray-400 transition-transform" :class="expanded ? 'rotate-180' : ''" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
            </div>
        </div>
        <div id="queues" x-show="expanded" x-transition>
            {{if .Queues}}
                {{template "partial_queues.html" .Queues}}
            {{else}}
                <div class="p-8 text-center">
                    <div class="text-gray-600 mb-2">üì≠</div>
                    <p class="text-gray-500 text-sm">No queues found for this consumer group</p>
                    <p class="text-gray-600 text-xs mt-1">Try selecting a different group from the dropdown above</p>
                </div>
            {{end}}
        </div>
    </div>
</div>
{{end}}

{{define "partial_stats.html"}}
<div class="grid grid-cols-2 md:grid-cols-4 gap-4">
    <div class="bg-gray-900 rounded-xl p-4 border border-gray-800">
        <div class="text-sm text-gray-500 mb-1">Pending</div>
        <div class="text-2xl font-bold text-yellow-400">{{.PendingTasks}}</div>
    </div>
    <div class="bg-gray-900 rounded-xl p-4 border border-gray-800">
        <div class="text-sm text-gray-500 mb-1">Active</div>
        <div class="text-2xl font-bold text-cyan-400">{{.ActiveTasks}}</div>
    </div>
    <div class="bg-gray-900 rounded-xl p-4 border border-gray-800">
        <div class="text-sm text-gray-500 mb-1">Completed</div>
        <div class="text-2xl font-bold text-green-400">{{.CompletedTasks}}</div>
    </div>
    <div class="bg-gray-900 rounded-xl p-4 border border-gray-800">
        <div class="text-sm text-gray-500 mb-1">Dead</div>
        <div class="text-2xl font-bold text-red-400">{{.DeadTasks}}</div>
    </div>
</div>
{{end}}

{{define "partial_queues.html"}}
<div class="divide-y divide-gray-800">
    {{range .}}
    <div class="p-4 flex items-center justify-between hover:bg-gray-800/50 transition-colors">
        <div class="flex items-center gap-3">
            <span class="text-lg">üì¨</span>
            <div>
                <a href="/queues/{{.Name}}" class="font-medium hover:text-strego-400">{{.Name}}</a>
            </div>
        </div>
        <div class="flex items-center gap-6 text-sm">
            <div class="flex items-center gap-2">
                <span class="w-2 h-2 rounded-full bg-yellow-500"></span>
                <span class="text-gray-400">{{.Pending}} pending</span>
            </div>
            <div class="flex items-center gap-2">
                <span class="w-2 h-2 rounded-full bg-cyan-500"></span>
                <span class="text-gray-400">{{.Active}} active</span>
            </div>
            <div class="flex items-center gap-2">
                <span class="w-2 h-2 rounded-full bg-red-500"></span>
                <span class="text-gray-400">{{.Dead}} dead</span>
            </div>
            <div class="flex items-center gap-2">
                <span class="w-2 h-2 rounded-full bg-green-500"></span>
                <span class="text-gray-400">{{.Processed}} completed</span>
            </div>
        </div>
    </div>
    {{else}}
    <div class="p-4 text-gray-500 text-sm">No queues found</div>
    {{end}}
    
    </div><!-- #dashboard-content -->
</div><!-- Dashboard wrapper -->
{{end}}
